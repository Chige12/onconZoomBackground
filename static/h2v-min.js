/* h2v.js version 3.5.2
    last modified at Jun 06 2015
    (c)tyz@freefielder.jp 
    For detail , please visit http://tategaki.info/h2v/
		Contact : tyz@freefielder.jp
    ** Don't remove this copyright message **
*/
var h2vconvert={version:"3.5.2",target:{},defaultval:{auto:true,chars:25,fontsize:"16px",lineInterval:0.4,rotate:true,bar:true,barForeColor:"#999",barBackColor:"#eee",showcredit:true,multiCols:true,splash:true,fontSet:"gothic"},fontSet:{gothic:"'ヒラギノ角ゴ ProN','Hiragino Kaku Gothic ProN','ヒラギノ角ゴ Pro','Hiragino Kaku Gothic Pro','メイリオ','Meiryo','ＭＳ ゴシック','MS Gothic','SimHei','HiraKakuProN-W3','STHeitiJ-Medium','TakaoExゴシック','TakaoExGothic','MotoyaLCedar','Droid Sans Japanese','Droid Sans Fallback',monospace",mincho:"'ヒラギノ明朝 ProN','Hiragino Mincho ProN','ヒラギノ明朝 Pro','Hiragino Mincho Pro','ＭＳ 明朝','MS Mincho','SimSun','HiraMinProN-W3','STHeitiJ-Medium','TakaoEx明朝','TakaoExMincho','MotoyaLCedar','Droid Sans Japanese','Droid Sans Fallback',monospace"},tmpdiv:null,styleSet:false,envs:{ua:"",isOld:false,isIE8:false,isIE:false,isFF38:false},init:function(d){var c=h2vconvert,a=c.envs.ua;if(c.envs.isOld){for(id in d){if(window.addEventListener){(function(e){window.addEventListener("load",function(){c.addErrBar(e,"最新のブラウザでは縦書きで閲覧できます")},false)})(id)}else{(function(e){window.attachEvent("onload",function(){c.addErrBar(e,"最新のブラウザでは縦書きで閲覧できます")})})(id)}}return false}if(document.addEventListener){if(!/safari/.test(a)){document.addEventListener("DOMContentLoaded",function(){c.startConvert(d)},false)}else{window.addEventListener("load",function(){c.startConvert(d)},false)}}else{if(/msie/.test(a)){try{document.documentElement.doScroll("left")}catch(b){setTimeout(function(){c.init(d)},0);return}c.startConvert(d)}else{window.onload=function(){c.startConvert(d)}}}},startConvert:function(d){var c=h2vconvert;if(!c.styleSet&&c.envs.isIE){h2v_ie.setStyleSheet()}c.styleSet=true;var f;for(f in d){if(tyz.getById(f)){c.target[f]=new c.h2v(d,f)}}for(f in d){if(tyz.getById(f)){try{c.ruby_enabler(f)}catch(b){c.onErr(tyz.getById(f),c.target[f])}c.target[f].org=tyz.getById(f).cloneNode(true)}}for(f in d){if(!tyz.getById(f)){continue}var e=c.target[f],a=tyz.getById(f);if(e.auto&&!tyz.getByClass(a,"h2v").length){if(e.splash){c.showSplash(f)}(function(i,g,h){setTimeout(function(){try{c.convert(i)}catch(j){c.onErr(g,h)}if(h.splash){c.hideSplash(i)}},1)})(f,a,e)}else{if(e.bar){c.addBar(e.id,"<span onclick=\"h2vconvert.switcher( '"+f+"');\">横→縦切替</span>")}a.style.visibility="visible"}}},convert:function(k){var c=h2vconvert,n=c.target[k],e=tyz.getById(k),m,l;if(n.converted==""){tyz.setStyles(e,{fontFamily:n.fontSet,fontSize:n.fontsize});if(tyz.getById("b"+k)){tyz.getById("b"+k).parentNode.removeChild(tyz.getById("b"+k))}var h,t=["SCRIPT","STYLE"];for(m=0;m<t.length;m++){h=tyz.getByTag(e,t[m]);for(l=h.length-1;l>=0;l--){e.parentNode.appendChild(h[l])}}var o=tyz.getByTag(e,"PRE"),a=[];for(m=0;m<o.length;m++){a[m]=o[m].cloneNode(true)}e.innerHTML=e.innerHTML.replace(/[\f\n\r\t\v\u0020\u00A0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u2028\u2029\u202f\u205f]+/g," ");o=tyz.getByTag(e,"PRE");for(m=0;m<o.length;m++){o[m].parentNode.replaceChild(a[m],o[m])}var q=tyz.getByTag(e,"CENTER"),s;for(m=q.length-1;m>=0;m--){s=tyz.newEle("P",{},{textAlign:"center"});s.appendChild(c.extractNodeContents(q[m]));q[m].parentNode.replaceChild(s,q[m])}e.normalize();n.html=c.extractNodeContents(e);var r=n.chars*n.fsPX;c.tmpdiv=c.createTmpdiv(k);c.tmpdiv.style.height=r+"px";var b=c.separateLines(k,n.html,n.fsPX,r,0);var g=tyz.newEle("DIV",{},{position:"absolute",left:"0"});for(m=0;m<b.length;m++){g.appendChild(b[m])}n.converted=g.cloneNode(true)}else{var g=n.converted.cloneNode(true);var r=n.chars*n.fsPX;c.tmpdiv=c.createTmpdiv(k)}var f=[];if(!n.multiCols){f[0]=c.oneCol(k,g,r*1+n.fsPX*1)}else{f=c.separateCols(k,g,r*1+n.fsPX*1)}e.innerHTML="";var p;if(n.multiCols){p=tyz.newEle("DIV",{"class":"h2v"},{fontSize:n.fontsize})}else{p=tyz.newEle("DIV",{"class":"h2v"},{fontSize:n.fontsize,direction:"rtl"})}if(n.bar){c.addBar(n.id,"<span onclick=\"h2vconvert.switcher( '"+k+"');\">縦→横切替</span>")}for(m=0;m<f.length;m++){p.appendChild(f[m]);if(m!=f.length-1){p.appendChild(tyz.newEle("DIV",{"class":"h2v_separator"}))}}if(n.showcredit){var d=tyz.newEle("DIV",{"class":"h2v_bar"},{marginTop:"10px",color:n.barForeColor,backgroundColor:n.barBackColor});d.innerHTML='<a href="http://tategaki.info/h2v/" target="_blank">h2v.js '+c.version+"</a>";p.appendChild(d)}n.cols=p.cloneNode(true);e.appendChild(p);e.appendChild(tyz.newEle("DIV",{"class":"h2v_clearfix"}));c.removeTmpdiv(k);if(e.style.visibility!="visible"){e.style.visibility="visible"}},separateLines:function(a,k,b,j,g){var n=[],h,d,f=h2vconvert,c=f.target[a];c.mL=0;c.mR=0;var m=j;if(c.flt){m=j-c.fH}while(h=f.seekNodes(a,k,b,m,g,true)){if(f.isDispBlock(h,a)=="b"||f.isList(h)||f.isThru(h)){if(h.className=="h2v_imgFloat_clear"){while(c.fW>0){var i=tyz.round(c.lineSpace*2+b,2);n[n.length]=tyz.newEle("SPAN",{"class":"h2v_e"},{marginLeft:c.lineSpace+"px",marginRight:c.lineSpace+"px",width:b+"px"});c.fW-=i}c.flt=false;m=j}if(f.getDispS(h,["display"],false,a).display=="none"){n[n.length]=tyz.newEle("DIV");n[n.length-1].appendChild(f.extractRange(k,h))}else{if(c.flt){c.fW-=(tyz.PX(h.style.paddingLeft)+tyz.PX(h.style.padingRight)+tyz.PX(h.style.marginLeft)+tyz.PX(h.style.marginRight)+tyz.PX(h.style.width))}n[n.length]=f.extractRange(k,h)}}else{if(c.flt&&c.floatCount==0){c.mL+=c.lineSpace;c.mR+=c.lineSpace;n[n.length]=tyz.newEle("SPAN",{"class":"h2v_imgFloat"},{marginRight:Math.round(c.fW)+"px",marginLeft:"-"+Math.round(c.fW)+"px"});if(c.flt=="right"){n[n.length-1].style.marginTop=m-c.fH+2+"px"}n[n.length-1].appendChild(f.extractRange(k,h))}else{l();d.appendChild(f.extractRange(k,h));n[n.length]=f.setTextAlign(d,m,c,b,0);if(k.hasChildNodes()){var e=k.firstChild;if((f.isInline(e)||e.nodeName=="SPAN")){if(e.innerHTML==""||e.innerHTML==" "){k.removeChild(e)}}}}}c.mL=0;c.mR=0;c.cH=0;if(c.fW>0){m=j-c.fH;c.floatCount++}else{m=j}c.okuri=null}if(k.hasChildNodes()){if(!(k.childNodes.length==1&&k.firstChild.nodeName=="#text"&&k.firstChild.nodeValue=="")){l();d.appendChild(f.extractNodeContents(k));n[n.length]=f.setTextAlign(d,m,c,b,4)}}return n;function l(){c.mL+=c.lineSpace;c.mR+=c.lineSpace;d=tyz.newEle("SPAN",{"class":"h2v_e"},{marginLeft:tyz.round(c.mL,2)+"px",marginRight:tyz.round(c.mR,2)+"px",width:b+"px"});if(c.flt){if(c.floatCount!=0&&c.flt=="left"){d.style.marginTop=c.fH+2+"px"}c.fW-=(b+c.mL+c.mR);if(c.fW<0){c.flt=false;c.floatCount=0}}}},setTextAlign:function(v,r,i,b,f){var j,a,m=h2vconvert;if(v.hasChildNodes()&&v.lastChild.nodeName=="BR"){f=4;if(v.childNodes.length!=1){v.removeChild(v.lastChild)}}switch(i.tAlign+f){case 0:case 4:case 7:return v}j=tyz.newEle("DIV",{},{fontSize:b+"px"});j.appendChild(v);m.tmpdiv.appendChild(j);var o,u=0,q=0,p,g,n,h=0,k=0;if(i.tAlign==3){if((o=r-v.offsetHeight)>0){p=v.childNodes;for(g=0;g<p.length;g++){n=p[g];switch(n.nodeName){case"#text":q+=n.nodeValue.length;break;case"SPAN":case"RUBY":case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"A":u++;break}}if((h=m.getExtraHeight(o,q))>0){v.style.lineHeight=b+h+"px"}o-=((q)*h);if(u>0&&(k=Math.round(o/u))!=0){for(g=0;g<p.length;g++){n=p[g];switch(n.nodeName){case"SPAN":case"RUBY":case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"A":n.style.marginBottom=tyz.PX(n.style.marginBottom)+k+"px";break}}}}}else{v.style.marginTop=tyz.PX(v.style.marginTop)+((r-v.offsetHeight)/i.tAlign)+"px"}m.tmpdiv.removeChild(j);return v},getExtraHeight:function(b,a){if(a==0){return 0}return tyz.round((b/a),2)},getExtraHeight_webkit:function(b,a){if(a==0){return 0}return Math.floor(b/a)},Okuri:function(e,d){if(!e){return null}if(e.nodeName=="#document-fragment"){return null}var b,c,a;b=e.nodeName;switch(b){case"#text":if(e.length==0){return this.Okuri(e.previousSibling,d)}if(e.length==1){return e}c=e.splitText(e.length-1);return e;case"SPAN":a=tyz.getAttr(e,"class");if(/h2v_kuto|h2v_kakko_b|h2v_tcy/.test(a)){d++;if(d>=3){return null}return this.Okuri(e.previousSibling||e.parentNode.previousSibling,d)}if(/h2v_sp|h2v_cho|h2v_komoji/.test(a)){return e.previousSibling||this.addBlank(e)}if(/h2v_alpha/.test(a)){if(/okurare/.test(a)){d++;if(d>=3){return e}return this.Okuri(e.previousSibling||e.parentNode.previousSibling,d)}return null}return this.Okuri(e.lastChild,d)||e.lastChild||this.addBlank(e);case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"SUB":case"SUP":case"A":case"MARK":case"TIME":case"METER":case"S":case"CITE":case"Q":case"DFN":case"ABBR":case"CODE":case"VAR":case"SAMP":case"KBD":return this.Okuri(e.lastChild,d)||e.lastChild||this.addBlank(e);case"RUBY":a=tyz.getAttr(e,"class");if(/okurare/.test(a)){d++;if(d>=3){return e}return this.Okuri(e.previousSibling||e.parentNode.previousSibling,d)}return null}return null},addBlank:function(b){var a=document.createTextNode("");b.parentNode.insertBefore(a,b);return a},seekNodes:function(O,J,x,Z,e,af){var D=J.firstChild,j,a=h2vconvert,R=a.target[O],ac,A=0,q=0,M=0;for(ac=0;ac<J.childNodes.length;ac++){D=J.childNodes[ac];j=D.nodeName;if(j=="SPAN"){j=a.getSpanFlag(D)}var X;if(ac==0&&af&&j=="#text"){D.nodeValue=D.nodeValue.replace(/^ /,"");if(D.nodeValue.length==0){continue}af=true}if(j=="#text"&&!(a.span_match(J,/h2v_/))&&D.nodeValue!=""){af=false;a.addVTags(D);D=J.childNodes[ac];j=D.nodeName;if(j=="SPAN"){j=a.getSpanFlag(D)}}switch(j){case"#text":q=(x+e*1)*D.length;if(q==0){break}M=Z-R.cH;if(M<=0){M=0}R.cH+=q;if(tyz.ceil(M,2)<=tyz.floor(q,2)){var ae=Math.floor(M/(x+e*1));if(ae==0){return R.okuri||D.previousSibling||a.addBlank(D)}else{if(ae<D.length){X=D.splitText(ae);return D}}}break;case 1:case 5:if(R.okuri){return R.okuri}if((Z-(R.cH-x))/x<1){R.okuri=a.Okuri(D.previousSibling,0)||D.previousSibling||a.addBlank(D)}R.cH+=x+e;D.style.lineHeight=x+e+"px";break;case 2:R.cH+=x+e;D.style.lineHeight=x+e+"px";D.style.marginBottom=e/2+"px";if(Z-R.cH<=1){return R.okuri||D.previousSibling||a.addBlank(D)}break;case 3:if(e!=0){tyz.setStyles(D,{lineHeight:x+e+"px",marginBottom:0});if(a.envs.isIE8){tyz.setStyles(D,{marginTop:e/2+"px",marginBottom:e/2+"px",lineHeight:"1em"})}}R.cH+=x+e;if(Z-R.cH<0){return R.okuri||D.previousSibling||a.addBlank(D)}break;case 10:R.cH+=x+e;if(Z-R.cH<0){return R.okuri||D.previousSibling||a.addBlank(D)}tyz.setStyles(D,{marginTop:e/2+"px",marginBottom:e/2+"px"});break;case 4:var q=tyz.PX(a.getDispS(D,["width"],true,O,false).width);tyz.setStyles(D,{letterSpacing:0+"px",lineHeight:"1em"});R.cH+=q+e;if(!D.done_h2v){tyz.setStyles(D,{width:q+"px",marginBottom:Math.ceil(q-x-e/2)+"px"})}if(Z-R.cH<0){if(D.done_h2v){return D}if(D.previousSibling){D.done_h2v=true;return D.previousSibling}else{if(a.isList(J)||J.nodeName=="SPAN"){D.done_h2v=true;return a.addBlank(D)}}}if(q<=x){D.className="okurare "+D.className}break;case 6:var G=a.getLS(D,O);var q=tyz.PX(a.getDispS(D,["width"],true,O,false).width);tyz.setStyles(D,{letterSpacing:G+"px",lineHeight:"1em"});R.cH+=q;if(!D.done_h2v){tyz.setStyles(D,{width:q+"px",marginBottom:Math.ceil(q-x-e/2)+"px",marginTop:e/2+"px"})}if(Z-R.cH<0){if(D.done_h2v){return D}if(D.previousSibling){D.done_h2v=true;return D.previousSibling}else{if(a.isList(J)||J.nodeName=="SPAN"){D.done_h2v=true;return a.addBlank(D)}}}if(q<=x){D.className="okurare "+D.className}break;case 7:case"RB":case"RBC":A=R.cH;D.style.lineHeight=x+e+"px";a.seekNodes(O,D,x,1000,e,false);R.cH=A;if(D.style.MozTransform){D.style.MozTransform=null}break;case 9:case"RT":case"RTC":A=R.cH;a.seekNodes(O,D,x,1000,0,false);R.cH=A;if(D.style.MozTransform){D.style.MozTransform=null}break;case 0:case 8:case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"SUB":case"SUP":case"A":case"MARK":case"TIME":case"METER":case"S":case"CITE":case"Q":case"DFN":case"ABBR":case"CODE":case"VAR":case"SAMP":case"KBD":case"DIV":case"P":case"BLOCKQUOTE":case"UL":case"OL":case"DL":case"LI":case"DT":case"DD":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"ADDRESS":case"ARTICLE":case"ASIDE":case"FOOTER":case"HEADER":case"HGROUP":case"NAV":case"DETAILS":case"SECTION":case"SUMMARY":var W=a.isDispBlock(D,O),r=a.getLS(D,O),d,k,B,V,z=D.parentNode,t;var V=0,z=D.parentNode;if(z&&z.nodeName!="#document-fragment"){V=a.getLS(D.parentNode,O)}switch(W){case"i":if(R.okuri&&Z-R.cH<0){return R.okuri}d=a.getNewProp(D,r,V,O,true),k=d.ds;B=tyz.PX(k.fontSize);d.s.marginLeft=(-B-tyz.PX(k.paddingTop)-tyz.PX(k.paddingBottom)-tyz.PX(k.borderTopWidth)-tyz.PX(k.borderBottomWidth))/2+"px";if(j==8){d.s.marginLeft=(tyz.PX(d.s.marginLeft)-(-tyz.PX(k.borderTopWidth)/2))+"px"}t=Z-tyz.PX(k.marginLeft)-tyz.PX(k.paddingLeft)-tyz.PX(k.borderLeftWidth);if(t<=0){t=B}a.setLineMargin(O,B,k);var s=a.seekNodes(O,D,B,t,r,af);af=false;if(s){var K=D.cloneNode(false),g=a.extractRange(D,s);K.appendChild(g);tyz.setStyles(K,d.s);K.done_h2v=true;tyz.setStyles(K,{marginBottom:0,paddingBottom:0,borderBottomWidth:0});tyz.setStyles(D,{marginLeft:0,paddingLeft:0,borderLeftWidth:0});D.parentNode.insertBefore(K,D);return K}R.cH+=d.xm*1;if(!D.done_h2v){d.s.width="1em";tyz.setStyles(D,d.s)}D.done_h2v=true;if(D.previousSibling){if(D.previousSibling.nodeType!=3){D.style.marginTop=-e/2+"px"}}if(D.nextSibling){D.style.marginBottom=-e/2+"px"}break;case"b":default:if(R.fW>0){var Y=tyz.getStyle(D,"clear")||a.getDispS(D,["clear"],false,O);if(Y&&Y!="none"){return w()}}d=a.getNewProp(D,r,0,O);k=d.ds;B=tyz.PX(k.fontSize);if(k.position!="static"){D.style.position="static"}var F=R.tAlign;switch(k.textAlign){case"justify":R.tAlign=3;break;case"center":R.tAlign=2;break;case"right":R.tAlign=1;break;case"left":default:R.tAlign=0;break}var C=tyz.PX(k.width),P=tyz.PX(k.height);Z=C==0?Z:C;d.xm=C==0?d.xm:0;t=Z-d.xm;if(t<=0){t=B}a.setLineMargin(O,B);var L=a.separateLines(O,D,B,t,r);tyz.setStyles(D,d.s);if(a.isInline(D)||D.nodeName=="SPAN"){tyz.setStyles(D,{cssFloat:"right"})}D.style.width=P==0?"auto":P+"px";if(C==0){D.style.height="auto"}else{D.style.height=null;D.style.minHeight=C+"px"}for(var T=0;T<L.length;T++){D.appendChild(L[T])}if(j=="LI"){var m=tyz.newEle("SPAN",{"class":"h2v_mark"});m.appendChild(document.createTextNode("・"));D.children[0].insertBefore(m,D.children[0].firstChild)}R.tAlign=F;return D;break}break;case"PRE":case"IFRAME":case"TABLE":case"TEXTAREA":case"FORM":case"AUDIO":case"CANVAS":case"EMBED":case"FIGURE":case"VIDEO":case"MENU":case"OBJECT":case"MAP":var k=a.getDispS(D,["width","marginTop","marginBottom","marginLeft","marginRight","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],true,O,true),Q=tyz.PX(k.marginLeft)+"px "+tyz.PX(k.marginTop)+"px "+tyz.PX(k.marginRight)+"px "+tyz.PX(k.marginBottom)+"px";tyz.setStyles(D,{margin:Q,paddingLeft:tyz.PX(k.paddingLeft)+"px",paddingRight:tyz.PX(k.paddingRight)+"px",borderLeftWidth:tyz.PX(k.borderLeftWidth)+"px",borderRightWidth:tyz.PX(k.borderRightWidth)+"px",width:tyz.PX(k.width)+"px",maxWidth:tyz.PX(k.width)+"px"});if(R.flt=="left"&&R.fW>0){tyz.setStyles(D,{paddingTop:R.fH+"px"})}return D;break;case"RUBY":if(D.done_h2v){delete D.done_h2v;D.style.lineHeight=x+e+"px";var b=(a.envs.isIE8)?tyz.PX(D.style.height):tyz.PX(a.getDispS(D,["height"],true,O).height),n=tyz.floor(x*0.7,2);R.cH+=b;if(R.mR-n<0){R.mR=n-x*(R.lineInterval/2)}if(Z-R.cH<0){if(Z-b>0){return D.previousSibling||a.addBlank(D)}return D}break}D=this.ruby_to_html4_style(D);A=R.cH;a.seekNodes(O,D,x,1000,e,false);R.cH=A;var b,aa,S,c,E,l,o,v=0,N,U,ad;tyz.setStyles(D,{fontSize:x+"px",lineHeight:x+e+"px"});var ag=tyz.newEle("SPAN",{"class":"h2v_e"});var f=D.cloneNode(true);var y=false;ag.appendChild(f);a.tmpdiv.appendChild(ag);b=f.offsetHeight;aa=f.offsetWidth;U=tyz.getByTag(f,"RBC");S=tyz.getByTag(f,"RB");if(a.envs.isFF38){S=tyz.getByClass(f,"psdo_rb")}var I=tyz.getByTag(f,"RT");if(a.envs.isFF38){I=tyz.getByClass(f,"psdo_rt")}if(I){I[0].style.display="none"}c=S[0].offsetHeight;if(I){I[0].style.display="table-cell"}if(b-c>0){S[0].style.lineHeight=Math.floor(b*x/c)+"px";y=true}a.tmpdiv.removeChild(ag);D.style.height=b+"px";if(y){D.style.marginTop=e/2+"px"}if(D.nextSibling&&D.nextSibling.nodeType!=3){D.style.marginBottom=e/2+"px"}b=b-v>0?b:v;R.cH+=b;if(Z-R.cH<0){if(D.previousSibling){D.done_h2v=true;return D.previousSibling}else{if(a.isList(J)||J.nodeName=="SPAN"){D.done_h2v=true;return a.addBlank(D)}}}if(b<=x){D.className="okurare "+D.className}D.done_h2v=true;var n=(aa-x);if(R.mR-n<0){R.mR=n-x*(R.lineInterval/2)}break;case"IMG":var k=a.getDispS(D,["width","height","marginLeft","marginRight","paddingLeft","paddingRight","paddingTop","paddingBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","marginTop","marginBottom","cssFloat"],true,O),q,h;if(a.envs.isIE8){k.height=tyz.PX(h2v_ie.getOH(D))-tyz.PX(k.paddingTop)-tyz.PX(k.paddingBottom)-tyz.PX(k.borderTopWidth)-tyz.PX(k.borderBottomWidth)}q=tyz.PX(k.height)+tyz.PX(k.paddingTop)+tyz.PX(k.paddingBottom)+tyz.PX(k.marginTop)+tyz.PX(k.marginBottom)+tyz.PX(k.borderTopWidth)+tyz.PX(k.borderBottomWidth);h=tyz.PX(k.width)-R.fsPX+tyz.PX(k.paddingLeft)+tyz.PX(k.paddingRight)+tyz.PX(k.borderLeftWidth)+tyz.PX(k.borderRightWidth);k.maxWidth=k.width;k.maxHeight=k.height;if(D.done_h2v){p();return D}if((k.cssFloat=="left"||k.cssFloat=="right")&&Z-q>x){if(R.flt){return w()}R.flt=k.cssFloat;k.cssFloat="none";tyz.setStyles(D,k);R.fH=q;R.fW=tyz.round((tyz.PX(k.width)+tyz.PX(k.paddingLeft)+tyz.PX(k.paddingRight)+tyz.PX(k.borderLeftWidth)+tyz.PX(k.borderRightWidth)+tyz.PX(k.marginLeft)+tyz.PX(k.marginRight)),2);R.floatCount=0;return D}k.cssFloat="none";tyz.setStyles(D,k);if(Z-q<0&&D.previousSibling){D.done_h2v=true;return D.previousSibling}R.cH+=q;if(Z-R.cH<0&&D.previousSibling){return D.previousSibling}p();break;case"BR":return R.okuri||D;case"HR":if(!D.done_h2v){D.done_h2v=true;D.style.height=tyz.PX(R.pageheight)*0.8+"px";return R.okuri||D.previousSibling||a.addBlank(D)}else{return D}default:var s=a.seekNodes(O,D,x,Z,0,false);if(s){return s}break}if(D.nextSibling){var ab=D.nextSibling;if(a.isDispBlock(ab,O)=="b"||a.isThru(ab)){return R.okuri||D}}}return R.okuri||false;function p(){if(h!=0){h=(h+tyz.PX(k.width))/2;R.mR=h+tyz.PX(k.marginRight)}}function w(){var i=tyz.newEle("DIV",{"class":"h2v_imgFloat_clear"});D.parentNode.insertBefore(i,D);return i}},getSpanFlag:function(b){var a=tyz.getAttr(b,"class");if(/h2v_kuto|h2v_kakko_b/.test(a)){return 1}if(/h2v_kakko_t/.test(a)){return 2}if(/h2v_komoji|h2v_rotate/.test(a)){return 3}if(/h2v_sp/.test(a)){return 4}if(/h2v_tcy/.test(a)){return 5}if(/h2v_alpha/.test(a)){return 6}if(/psdo_rb/.test(a)){return 7}if(/bousen_/.test(a)){return 8}if(/psdo_rt/.test(a)){return 9}if(/h2v_cho/.test(a)){return 10}return 0},oneCol:function(h,f,g){this.tmpdiv.appendChild(f);var b=f.offsetWidth+1,e=f.offsetHeight,d=tyz.PX(this.target[h].pagewidth)-3;if(d>b){b=d;f.style.width=b+"px"}var a=tyz.newEle("DIV",{"class":"h2v_pinner"},{width:b+"px"});a.appendChild(f);var c=tyz.newEle("DIV",{"class":"h2v_oc"},{width:d+"px",height:e+15+"px",minHeight:g+"px"});c.appendChild(a);return c},separateCols:function(k,l,r){var h=[],f=tyz.PX(this.target[k].pagewidth),j,o;l.normalize();o=document.createDocumentFragment();o.appendChild(l);i();a("PRE");a("TABLE");var d,t,u,q,b=0,p=0,m,c,v=0;while(1){u=0;j=f+Math.ceil(p);d=g(l);if(d===null){break}t=Math.ceil(b+p+5);if(u-f>0){u=f}q=(p<=0?"0":"-"+Math.floor(p))+"px";m=tyz.newEle("DIV",{"class":"h2v_pinner"},{width:t+"px",right:q});m.appendChild(this.extractRange(l,d.cnt));c=this.envs.isIE8?h2v_ie.getOH(m):this.getDispS(m,["height"],true,k,true).height;h[h.length]=tyz.newEle("DIV",{"class":"h2v_page"},{width:u+"px",minHeight:r+"px",height:c});h[h.length-1].appendChild(m);b=0;p=v;v=0}q=(p<=0?0:"-"+Math.floor(p))+"px";t=Math.ceil(b+p+5);m=tyz.newEle("DIV",{"class":"h2v_pinner"},{width:t+"px",right:q});m.appendChild(this.extractNodeContents(l));c=this.envs.isIE8?h2v_ie.getOH(m):this.getDispS(m,["height"],true,k,true).height;h[h.length]=tyz.newEle("DIV",{"class":"h2v_page"},{width:j+"px",minHeight:r+"px",height:c});h[h.length-1].appendChild(m);return h;var e,s;function g(A){var H=A.childNodes,D,B={},z,E,F;for(D=0;D<H.length;D++){if(H[D].nodeName=="#text"){continue}if(!H[D].style){continue}E=H[D].style;B.mR=tyz.PX(E.marginRight);B.bR=tyz.PX(E.borderRightWidth);B.pR=tyz.PX(E.paddingRight);B.w=tyz.PX(E.width);B.pL=tyz.PX(E.paddingLeft);B.bL=tyz.PX(E.borderLeftWidth);B.mL=tyz.PX(E.marginLeft);z=B.mR+B.bR+B.pR+B.w+B.pL+B.bL;if(h2vconvert.isThru(H[D])||h2vconvert.span_match(H[D],"h2v_e")||h2vconvert.isDispBlock(H[D],k)=="i"||(h2vconvert.isDispBlock(H[D],k)=="b"&&!H[D].hasChildNodes())){b+=z;if(b-j>0){if(z-f>=0){b+=B.mL;u=b-p;return{cnt:H[D],desc:"e"}}b-=z;u=b-p;if(e){e.style.marginRight=s-b+"px";e.style.marginLeft=-(s-b)+"px";H[D].parentNode.insertBefore(e.cloneNode(true),H[D]);e=null}return{cnt:H[D].previousSibling||h2vconvert.addBlank(H[D]),desc:"e"}}b+=B.mL;continue}else{if(h2vconvert.span_match(H[D],"h2v_imgFloat")){var G=b+z;if(G-j>0){s=G;e=H[D].cloneNode(true)}continue}}var x=b*1;b+=B.mR;if(b-j>0){v=j-x;F=H[D].cloneNode(false);H[D].parentNode.insertBefore(F,H[D]);b+=B.bR+B.pR+B.w+B.pL+B.bL+B.mL;u=f;return{cnt:F,desc:""}}b+=B.bR+B.pR;if(b-j>0){v=j-x;F=H[D].cloneNode(false);H[D].parentNode.insertBefore(F,H[D]);b+=B.w+B.pL+B.bL+B.mL;u=f;return{cnt:F,desc:""}}var w=b*1,C=g(H[D]),y=b-w;if(y-Math.round(B.w)<0){y=B.w}if(C===null){b=w+y;if(b-j>0){v=j-x;F=H[D].cloneNode(true);H[D].parentNode.insertBefore(F,H[D]);b+=B.pL+B.bL+B.mL;u=f;return{cnt:F,desc:""}}b+=B.pL+B.bL;if(b-j>0){v=j-x;F=H[D].cloneNode(true);H[D].parentNode.insertBefore(F,H[D]);b+=B.mL;u=f;return{cnt:F,desc:""}}b+=B.mL;if(b-j>0){v=j-x;F=H[D].cloneNode(true);H[D].parentNode.insertBefore(F,H[D]);u=f;return{cnt:F,desc:""}}continue}b+=y+B.pL+B.bL+B.mL;if(C.desc=="e"&&B.w!=0){F=H[D].cloneNode(true);H[D].parentNode.insertBefore(F,H[D]);C.cnt=F;C.desc="";v=b-x}else{v+=B.mR+B.bR+B.pR}return C}return null}function n(x,w){while(1){if(x.nodeName=="#document-fragment"){return false}if(tyz.getAttr(x,"class")==w){return x}x=x.parentNode}}function i(){var y=tyz.getByTag(l,"IMG"),x,F,C,D,A=0,E=0,z=0,w=0,B=0;for(C=0;C<y.length;C++){x=n(y[C].parentNode,"h2v_e");if(x===false){continue}D=x.style;A=tyz.PX(D.width)+tyz.PX(D.marginLeft)+tyz.PX(D.marginRight)+tyz.PX(D.paddingLeft)+tyz.PX(D.paddingRight)+tyz.PX(D.borderLeftWidth)+tyz.PX(D.borderRightWidth);if(A-f>0){E=tyz.PX(y[C].style.width);z=tyz.PX(y[C].style.height);if(h2vconvert.envs.isIE8){z=tyz.PX(h2v_ie.getOH(y[C]))}w=E-(A-f);if(w>0){B=z*w/E;tyz.setStyles(y[C],{width:w+"px",height:B+"px"});x.style.marginRight=tyz.PX(D.marginRight)-(A-f)+"px"}}}}function a(x){var w=tyz.getByTag(l,x),z=0,B,y=0,A=0;for(z=0;z<w.length;z++){B=w[z].style;y=tyz.PX(B.width)+tyz.PX(B.paddingLeft)+tyz.PX(B.paddingRight)+tyz.PX(B.marginRight)+tyz.PX(B.marginLeft)+tyz.PX(B.borderLeftWidth)+tyz.PX(B.borderRightWidth);if(y-f>0){A=tyz.PX(B.width)-(y-f);if(A>0){w[z].style.width=A+"px"}}}}},addVTags:function(c){var k=c.cloneNode(true);k.nodeValue=k.nodeValue.replace(this.orig_ex,function(j){return h2vconvert.repl_a[j]});result=[],cname=[],place=[],plength=[];while(result=this.ptn.exec(k.nodeValue)){if(result[1]){cname[cname.length]="h2v_komoji"}else{if(result[2]){cname[cname.length]="h2v_cho"}else{if(result[3]){cname[cname.length]="h2v_kuto"}else{if(result[4]){cname[cname.length]="h2v_sp"}else{if(result[5]){cname[cname.length]="h2v_alpha"}else{if(result[6]){cname[cname.length]="h2v_kakko_t_nr"}else{if(result[7]){cname[cname.length]="h2v_kakko_b_nr"}else{if(result[8]){cname[cname.length]="h2v_kakko_t"}else{if(result[9]){cname[cname.length]="h2v_kakko_b"}else{if(result[10]){cname[cname.length]="h2v_rotate"}else{if(result[11]){cname[cname.length]="h2v_kuto_s"}}}}}}}}}}}plength[plength.length]=result[0].length;place[place.length]=this.ptn.lastIndex-result[0].length}var i,d,a,b,e,g=document.createDocumentFragment();g.appendChild(k);for(e=cname.length-1;e>=0;e--){i=k.splitText(place[e]+plength[e]);d=k.splitText(place[e]);a=tyz.newEle("SPAN",{"class":cname[e]});b=document.createTextNode(d.nodeValue);a.appendChild(b);g.replaceChild(a,d)}var f;if(this.envs.isIE8){var h=tyz.newEle("DIV");h.appendChild(g.cloneNode(true));h.normalize();g=document.createDocumentFragment();g.appendChild(h2vconvert.extractNodeContents(h))}else{g.normalize()}while(g.firstChild){c.parentNode.insertBefore(g.firstChild,c)}c.parentNode.removeChild(c)},resizeTimer:null,resizeFlag:false,resizeW:0,doresize:function(){if(!h2vconvert.resizeFlag){h2vconvert.resizeFlag=true;h2vconvert.resizeTimer=setInterval(function(){if(h2vconvert.resizeW==window.innerWidth){clearInterval(h2vconvert.resizeTimer);h2vconvert.resizing();setTimeout(function(){h2vconvert.resizeFlag=false},1)}else{h2vconvert.resizeW=window.innerWidth;return false}},100)}else{return false}},resizing:function(){var c=h2vconvert,a,e,d,b;for(d in c.target){a=tyz.getById(d);if(tyz.getByClass(a,"h2v").length==0){return false}e=c.target[d];b=tyz.getById(d).offsetWidth-tyz.getPxStyle(a,"paddingLeft")-tyz.getPxStyle(a,"paddingRight")-tyz.getPxStyle(a,"borderLeftWidth")-tyz.getPxStyle(a,"borderRightWidth");if(c.reConvert(e,b)){(function(h,f,g){setTimeout(function(){try{h2vconvert.convert(h)}catch(i){h2vconvert.onErr(f,g)}},1)})(d,a,e)}}},reConvert:function(b,a){if(!b.cols){if(b.fixedwidth&&Math.round(tyz.PX(b.fixedwidth))<=a){b.pagewidth=b.fixedwidth}else{b.pagewidth=a+"px"}return true}else{if(b.fixedwidth&&Math.round(tyz.PX(b.fixedwidth))<=a){if(b.pagewidth==b.fixedwidth){return false}else{b.pagewidth=b.fixedwidth;return true}}else{if(Math.round(tyz.PX(b.pagewidth))==a){return false}else{b.pagewidth=a+"px";return true}}}},getNewProp:function(k,c,i,b,j){var d=h2vconvert.getDispS(k,["fontSize","width","height","marginTop","marginLeft","marginBottom","marginRight","paddingTop","paddingLeft","paddingBottom","paddingRight","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","textAlign","position","display"],j,b),h=tyz.PX(d.marginLeft)+tyz.PX(d.marginRight)+tyz.PX(d.paddingLeft)+tyz.PX(d.paddingRight)+tyz.PX(d.borderLeftWidth)+tyz.PX(d.borderRightWidth),g=(tyz.PX(d.marginLeft)-(-i/2)-c/2)+"px "+tyz.PX(d.marginTop)+"px "+tyz.PX(d.marginRight)+"px "+tyz.PX(d.marginBottom)+"px",l=tyz.PX(d.paddingLeft)+"px "+tyz.PX(d.paddingTop)+"px "+(tyz.PX(d.paddingRight)-(c/2))+"px "+tyz.PX(d.paddingBottom)+"px",a={margin:g,padding:l,fontSize:tyz.PX(d.fontSize)+"px",lineHeight:tyz.PX(d.fontSize)-(-c)+"px",letterSpacing:"normal"},f=this.rotateBdr({Top:d.borderTopStyle,Right:d.borderRightStyle,Bottom:d.borderBottomStyle,Left:d.borderLeftStyle},k,b);for(var e in f){a[e]=f[e]}return{s:a,xm:h,ds:d}},rotateBdr:function(a,f,h){var e={};for(var g in a){if(a[g]&&a[g]!="none"){e["border"+c(g)+"Style"]=a[g];var b=[];b.push("border"+g+"Width","border"+g+"Color");var d=this.getDispS(f,b,false,h);e["border"+c(g)+"Width"]=d["border"+g+"Width"];e["border"+c(g)+"Color"]=d["border"+g+"Color"]}else{e["border"+c(g)+"Style"]="none";e["border"+c(g)+"Width"]="0"}}return e;function c(j){var i={Top:"Right",Right:"Bottom",Bottom:"Left",Left:"Top"};return i[j]}},setLineMargin:function(f,a,c){var e=this.target[f];if(c){a+=(tyz.PX(c.marginTop)+tyz.PX(c.marginBottom)+tyz.PX(c.paddingTop)+tyz.PX(c.paddingBottom))/2}if(e.fsPX-a<0){var d=(a-e.fsPX)/2;if(e.mL-d<0){e.mL=d}var b=(a-e.fsPX)/2;if(e.mR-b<0){e.mR=b}}},addBar:function(d,c){var a="b"+d,b=tyz.getById(a)||tyz.newEle("DIV",{"class":"h2v_bar",id:a},{color:this.target[d].barForeColor,backgroundColor:this.target[d].barBackColor});b.innerHTML=c;tyz.getById(d).insertBefore(b,tyz.getById(d).firstChild)},addErrBar:function(d,c){var a="b"+d,b=tyz.getById(a)||tyz.newEle("DIV",{"class":"h2v_bar",id:a},{color:"#999",backgroundColor:"#eee"});b.innerHTML=c;tyz.getById(d).insertBefore(b,tyz.getById(d).firstChild)},showSplash:function(c){var a=tyz.getById(c),b=tyz.newEle("DIV",{"class":"h2v_splash",id:"sp"+c},{top:a.offsetTop*1+15+"px",left:a.offsetLeft+"px",width:a.offsetWidth-58+"px"});b.innerHTML="縦書きレイアウトに変換しています…";a.parentNode.appendChild(b);a.style.opacity="0.5";if(this.envs.isIE8){a.style.filter="alpha(opacity=50)"}},hideSplash:function(c){var b=tyz.getById("sp"+c),a=tyz.getById(c).style;a.opacity=this.target[c].orgOpacity;if(this.envs.isIE8){a.filter=this.target[c].orgOpacity}if(!b){return}b.style.opacity="0";setTimeout(function(){b.parentNode.removeChild(b)},500)},onErr:function(a,b){a.innerHTML="";a.parentNode.replaceChild(b.org.cloneNode(true),a);this.addBar(b.id,'<a href="http://tategaki.info/h2v/" target="_blank">h2v.js Failed!</a>');tyz.setStyles(tyz.getById(b.id),b.orgStyles)},isDispBlock:function(a,c){if(!this.isBlock(a)&&!this.isInline(a)&&a.nodeName!="SPAN"){return false}var b=h2vconvert.getDispS(a,["display"],false,c).display;switch(b){case"block":return"b";case"inline-block":case"inline":return"i";default:return false}},isBlock:function(a){switch(a.nodeName){case"DIV":case"P":case"BLOCKQUOTE":case"UL":case"OL":case"DL":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"ADDRESS":case"ARTICLE":case"ASIDE":case"FOOTER":case"HEADER":case"HGROUP":case"NAV":case"DETAILS":case"SECTION":case"SUMMARY":return true;default:return false}},isList:function(a){switch(a.nodeName){case"LI":case"DT":case"DD":return true;default:return false}},isInline:function(a){switch(a.nodeName){case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"SUB":case"SUP":case"A":case"MARK":case"TIME":case"METER":case"S":case"CITE":case"Q":case"DFN":case"ABBR":case"CODE":case"VAR":case"SAMP":case"KBD":return true;default:return false}},isThru:function(a){switch(a.nodeName){case"PRE":case"IFRAME":case"TABLE":case"TEXTAREA":case"FORM":case"AUDIO":case"CANVAS":case"EMBED":case"FIGURE":case"VIDEO":case"MENU":case"OBJECT":case"MAP":return true;default:return false}},span_match:function(a,b){if(a.nodeName=="SPAN"&&tyz.getAttr(a,"class").match(b)){return true}return false},getLS:function(b,d){var c=this.getDispS(b,["letterSpacing"],false,d),a=c.letterSpacing;switch(a){case"normal":case"initial":return 0;default:return tyz.PX(a)}},getDispS:function(a,b,k,e,h){var m=a.cloneNode(k),f=a.parentNode,i=0,g,n,l,c,j;while(f&&f.nodeName!="#document-fragment"){g=f.cloneNode(false);g.appendChild(m);m=g;i++;f=f.parentNode}if(h){n=m.cloneNode(k);this.tmpdiv.appendChild(n)}else{l=tyz.newEle("DIV",{id:"h2v_tmp_sq"},{height:this.target[e].pageheight,width:this.target[e].pageheight});n=m.cloneNode(true);l.appendChild(n);this.tmpdiv.appendChild(l)}for(j=0;j<i;j++){n=n.lastChild}c=tyz.getStyles(n,b);this.tmpdiv.removeChild(this.tmpdiv.lastChild);return c},createTmpdiv:function(d){if(!tyz.getById("h2v_tmp_div")){var c=this.target[d].orgHeight*tyz.getById(d).offsetWidth*tyz.PX(this.target[d].orgStyles.fontSize)/(this.target[d].chars*tyz.PX(this.target[d].fontsize)),b=Math.ceil(c*(1+(this.target[d].lineInterval)*2)),a=tyz.newEle("DIV",{id:"h2v_tmp_div","class":"h2v"},{width:b+"px",fontSize:this.target[d].fontsize,fontFamily:this.target[d].fontSet});tyz.getById(d).appendChild(a);return a}else{return tyz.getById("h2v_tmp_div")}},removeTmpdiv:function(a){if(tyz.getById("h2v_tmp_div")){tyz.getById(a).removeChild(tyz.getById("h2v_tmp_div"))}},rubyEnabled:false,ruby_enabler:function(q){setTimeout(function(){h2vconvert.rubyEnabled=true},1);var p=h2vconvert.envs,x=p.ua,w,v,t,C,A,m=tyz.getByTag(tyz.getById(q),"RUBY");if(/webkit/.test(x)||p.isIE){var e,l,u,f;var z;for(w=m.length-1;w>=0;w--){m[w].normalize();e=tyz.getByTag(m[w],"RBC");l=tyz.getByTag(m[w],"RTC");if(e.length!=l.length){continue}u=tyz.getByTag(m[w],"RB");f=tyz.getByTag(m[w],"RT");A=document.createDocumentFragment();if(u.length!=0){for(v=0;v<u.length;v++){C=tyz.newEle("RUBY");C.appendChild(document.createTextNode(u[v].innerHTML));C.appendChild(f[v].cloneNode(true));A.appendChild(C.cloneNode(true))}}else{for(v=0;v<f.length;v++){C=tyz.newEle("RUBY");z=f[v].previousSibling;while(z.nodeName!="#text"){try{z=z.previousSibling}catch(c){z=f[v].previousSibling;break}}C.appendChild(z.cloneNode(true));C.appendChild(f[v].cloneNode(true));A.appendChild(C.cloneNode(true))}}m[w].parentNode.replaceChild(A,m[w])}return}var b,d,o,h,f,u,l;for(w=m.length-1;w>=0;w--){m[w].innerHTML=m[w].innerHTML.replace(/[\n\r\t]/g,"");m[w].normalize();b=document.defaultView.getComputedStyle(m[w],null);d=b.fontSize.replace("px","");o=b.lineHeight.replace("px","");h=(o-d)/2-2;h=h<=0?0:h;f=tyz.getByTag(m[w],"RT");u=tyz.getByTag(m[w],"RB");l=tyz.getByTag(m[w],"RTC");if(l.length==0){var B,a,g,y;if(f.length<2){B=document.createDocumentFragment();a=document.createDocumentFragment()}else{B=tyz.newEle("RBC");a=tyz.newEle("RTC")}for(v=0;v<m[w].childNodes.length;v++){g=m[w].childNodes[v];switch(g.nodeName){case"#text":y=tyz.newEle("RB");y.appendChild(g.cloneNode(true));B.appendChild(y);break;case"RB":B.appendChild(g.cloneNode(true));break;case"RT":a.appendChild(g.cloneNode(true));if(h){a.lastChild.style.MozTransform="translate(0,"+h+"px)"}break}}A=document.createDocumentFragment();for(t=0;t<B.childNodes.length;t++){C=tyz.newEle("RUBY");C.appendChild(B.childNodes[t].cloneNode(true));C.appendChild(a.childNodes[t].cloneNode(true));A.appendChild(C.cloneNode(true))}m[w].parentNode.replaceChild(A,m[w])}else{A=document.createDocumentFragment();for(t=0;t<u.length;t++){C=tyz.newEle("RUBY");C.appendChild(u[t].cloneNode(true));C.appendChild(f[t].cloneNode(true));A.appendChild(C.cloneNode(true))}m[w].parentNode.replaceChild(A,m[w]);if(h){l[0].style.MozTransform="translate(0,"+h+"px)"}}}if(!h2vconvert.rubyEnabled){var n=tyz.newEle("STYLE",{title:"h2v_add"});tyz.getByTag(document,"HEAD")[0].appendChild(n);var r=document.styleSheets,w;for(w=0;w<r.length;w++){if(r[w].title=="h2v_add"){n=r[w];break}}n.insertRule("ruby{display:inline-table;text-align:center !important ;text-indent:0 !important;margin:0;padding:0 !important;vertical-align:bottom}",n.cssRules.length);n.insertRule("ruby>rb,ruby>rbc{display:table-row-group;}",n.cssRules.length);n.insertRule("ruby>rt,ruby>rtc{display:table-header-group;font-size:8px;line-height:1em;letter-spacing:0 !important;font-weight:normal !important;font-style:normal !important;}",n.cssRules.length);n.insertRule("rbc>rb{display:table-cell;}",n.cssRules.length);n.insertRule("rtc>rt{display:table-cell;letter-spacing:0 !important;line-height:1em;}",n.cssRules.length);n.insertRule("rp{display:none !important;}",n.cssRules.length);if(h2vconvert.envs.isFF38){n.insertRule(".h2v_e ruby>.psdo_rb,#h2v_tmp_div ruby>.psdo_rb{display:table-cell !important;width:1em;max-width:1em;font-size:100%;word-wrap:break-word;word-break:break-all;vertical-align:middle;position:static;}",n.cssRules.length);n.insertRule(".h2v_e .psdo_rt,#h2v_tmp_div .psdo_rt{display:table-cell !important;font-size:70%;width:1em;max-width:1em;word-wrap:break-word;word-break:break-all;vertical-align:middle;position:static;}",n.cssRules.length)}if(/opera/gi.test(x)){n.insertRule("ruby,ruby>rb,ruby>rbc,ruby>rt,ruby>rtc,rbc>rb,rtc>rb{line-height:1em;}",n.cssRules.length);n.insertRule("ruby{vertical-align:0.95em;}",n.cssRules.length)}}return},ruby_to_html4_style:function(l){var h=h2vconvert,g=tyz.newEle("RUBY"),d,e,b,a,n;d=tyz.getByTag(l,"RT");e=tyz.getByTag(l,"RBC");b=tyz.getByTag(l,"RTC");if(b.length==0){var m,k,c,j;if(d.length<2){m=document.createDocumentFragment();k=document.createDocumentFragment()}else{m=tyz.newEle("RBC");k=tyz.newEle("RTC")}for(var f=0;f<l.childNodes.length;f++){c=l.childNodes[f];switch(c.nodeName){case"#text":c.nodeValue=c.nodeValue.replace(/^\s+|\s+$/,"");j=tyz.newEle("RB");j.appendChild(c.cloneNode(true));j.innerHTML='<span class="psdo_rb_inner">'+j.innerHTML+"</span>";m.appendChild(j);break;case"RB":j=c.cloneNode(true);j.innerHTML='<span class="psdo_rb_inner">'+j.innerHTML+"</span>";m.appendChild(j);break;case"RT":j=c.cloneNode(true);j.innerHTML='<span class="psdo_rt_inner">'+j.innerHTML+"</span>";k.appendChild(j);break}}g.appendChild(m);g.appendChild(k);l.parentNode.replaceChild(g,l);return g}else{if(e.length!=0){return l}throw new Error()}throw new Error()},ruby_to_html4_style_ff38:function(l){var h=h2vconvert,g=tyz.newEle("RUBY"),d,e,b,a,n;d=tyz.getByTag(l,"RT");e=tyz.getByTag(l,"RBC");b=tyz.getByTag(l,"RTC");if(b.length==0){var m,k,c,j;if(d.length<2){m=document.createDocumentFragment();k=document.createDocumentFragment()}else{m=tyz.newEle("RBC");k=tyz.newEle("RTC")}for(var f=0;f<l.childNodes.length;f++){c=l.childNodes[f];switch(c.nodeName){case"#text":c.nodeValue=c.nodeValue.replace(/^\s+|\s+$/,"");j=tyz.newEle("SPAN");j.setAttribute("class","psdo_rb");j.appendChild(c.cloneNode(true));j.innerHTML='<span class="psdo_rb_inner">'+j.innerHTML+"</span>";m.appendChild(j);break;case"RB":j=tyz.newEle("SPAN");j.setAttribute("class","psdo_rb");j.innerHTML='<span class="psdo_rb_inner">'+c.innerHTML+"</span>";m.appendChild(j);break;case"RT":j=tyz.newEle("SPAN");j.setAttribute("class","psdo_rt");j.innerHTML='<span class="psdo_rt_inner">'+c.innerHTML+"</span>";k.appendChild(j);break}}g.appendChild(m);g.appendChild(k);l.parentNode.replaceChild(g,l);return g}else{if(e.length!=0){return l}throw new Error()}throw new Error()},h2v:function(g,h){this.id=h;var c=g[h],f=h2vconvert,a,e,b;for(a in f.defaultval){this[a]=f.defaultval[a]}for(a in c){this[a]=c[a]}e=tyz.getById(h);b=e.offsetWidth-tyz.getPxStyle(e,"paddingLeft")-tyz.getPxStyle(e,"paddingRight")-tyz.getPxStyle(e,"borderLeftWidth")-tyz.getPxStyle(e,"borderRightWidth");this.pagewidth=c.pagewidth!==undefined?c.pagewidth:(b+"px");this.fixedwidth=c.pagewidth!==undefined?c.pagewidth:false;if(tyz.PX(this.pagewidth)>b){this.pagewidth=b+"px"}this.fsPX=tyz.PX(this.fontsize);this.pageheight=this.chars*this.fsPX+"px";this.mR=0;this.mL=0;this.lineSpace=Math.round(this.fsPX*this.lineInterval/2);this.cH=0;this.tAlign=0;this.org=document.createDocumentFragment();this.org.appendChild(e.cloneNode(true));this.orgStyles=tyz.getStyles(e,["fontSize","fontFamily"]);this.orgStyles.visibility="visible";this.orgHeight=e.offsetHeight;this.orgOpacity=f.envs.isIE8?tyz.getStyle(e,"msFilter"):tyz.getStyle(e,"opacity");this.okuri=null;this.html="";this.converted="";if(this.fontSet.toLowerCase()=="mincho"){this.fontSet=f.fontSet.mincho}else{this.fontSet=f.fontSet.gothic}this.flt=false;this.floatCount=0;this.justify=false},extractRange:function(a,b){var c=document.createRange();c.setStartBefore(a.firstChild);c.setEndAfter(b);return c.extractContents()},extractNodeContents:function(b){var a=document.createRange();a.selectNodeContents(b);return a.extractContents()},switcher:function(e){var d=this.target[e],a=tyz.getById(e);if(tyz.getByClass(a,"h2v").length){a.innerHTML="";a.parentNode.replaceChild(d.org.cloneNode(true),a);a=tyz.getById(e);if(d.bar){this.addBar(d.id,"<span onclick=\"h2vconvert.switcher( '"+e+"');\">横→縦切替</span>")}tyz.setStyles(a,d.orgStyles)}else{var b=a.offsetWidth-tyz.getPxStyle(a,"paddingLeft")-tyz.getPxStyle(a,"paddingRight")-tyz.getPxStyle(a,"borderLeftWidth")-tyz.getPxStyle(a,"borderRightWidth");if(this.reConvert(d,b)){if(d.splash){this.showSplash(e)}(function(h,f,g){setTimeout(function(){try{h2vconvert.convert(h)}catch(i){h2vconvert.onErr(f,g)}if(g.splash){h2vconvert.hideSplash(h)}},1)})(e,a,d)}else{try{a.innerHTML="";if(d.bar){this.addBar(d.id,"<span onclick=\"h2vconvert.switcher( '"+e+"');\">縦→横切替</span>")}a.style.fontFamily=d.fontSet;a.appendChild(d.cols.cloneNode(true));a.appendChild(tyz.newEle("DIV",{"class":"h2v_clearfix"}))}catch(c){this.onErr(a,d)}}}},komojis:["ぁ","ぃ","ぅ","ぇ","ぉ","っ","ゃ","ゅ","ょ","ゎ","ァ","ィ","ゥ","ェ","ォ","ッ","ャ","ュ","ョ","ヮ"].join(""),kakko_t_kagi_a:["「","『"],kakko_t_kagi_r_a:["﹁","﹃"],kakko_t_a:["（","｛","〈","《","〔","【"],kakko_t_r_a:["︵","︷","︿","︽","︹","︻"],kakko_b_kagi_a:["」","』"],kakko_b_kagi_r_a:["﹂","﹄"],kakko_b_a:["）","｝","〉","》","〕","】"],kakko_b_r_a:["︶","︸","﹀","︾","︺","︼"],dash_a:["―","—","‥","ー"],dash_r_a:["︱","︱","︰","丨"],kakkos_tr:["［","〘"].join(""),kakkos_br:["］","〙"].join(""),rotates:["↑","↓","→","←","…","＝","−","：","；","＜","＞"].join(""),rotate_mirrors:["〜","～"].join(""),kutos:["。","、","，"].join(""),orig_ex:null,repl_a:[],ptn:null};var tyz={getByClass:function(d,a){if(d.getElementsByClassName){return d.getElementsByClassName(a)}else{var e=tyz.getByTag(d,"*"),b=[];for(var c=0;c<e.length;c++){if(tyz.getAttr(e[c],"class")==a){b[b.length]=e[c]}}return b}},getById:function(a){return document.getElementById(a)},getByTag:function(b,a){return b.getElementsByTagName(a)},getStyle:function(a,b){return document.defaultView.getComputedStyle(a,null)[b]},getStyles:function(c,e){var b=document.defaultView.getComputedStyle(c,null),d={};for(var a=0;a<e.length;a++){d[e[a]]=b[e[a]]}return d},getAttr:function(b,a){return b.getAttribute(a)||""},PX:function(a){a+="";if(a==""){return 0}if(a.match("px")){return tyz.round(a.replace("px","")*1,2)}if(a.match("pt")){return tyz.round(a.replace("pt","")*4/3,2)}if(a.match("em")){return tyz.round(a.replace("em","")*h2vconvert.defaultFS*1,2)}if(a.match(/[^0-9\.]/g)){return 0}return tyz.round(a*1,2)},getPxStyle:function(b,c){var a=document.defaultView.getComputedStyle(b,null);return this.PX(a[c])},setStyles:function(c,b){for(var a in b){c.style[a]=b[a]}return c},newEle:function(d,c,f){var g=document.createElement(d),b,e;for(b in c){g.setAttribute(b,c[b])}for(e in f){g.style[e]=f[e]}return g},round:function(c,b){var a=Math.pow(10,b);return Math.round(c*a)/a},ceil:function(c,b){var a=Math.pow(10,b);return Math.ceil(c*a)/a},floor:function(c,b){var a=Math.pow(10,b);return Math.floor(c*a)/a}};var h2v_ie={getStyle:function(a,b){if(h2v_ie.checkVal_w(b)||h2v_ie.checkVal_h(b)){return h2v_ie.getSize(a,b)+"px"}if(b=="fontSize"){return h2v_ie.getFontSize(a)+"px"}if(b=="cssFloat"){return a.currentStyle.styleFloat}if(b=="letterSpacing"){return h2v_ie.getSize(a,b)+"px"}return a.currentStyle[b]},getStyles:function(b,d){var c={},a;for(a=0;a<d.length;a++){c[d[a]]=h2v_ie.getStyle(b,d[a])}return c},getPxStyle:function(a,c){var b=h2v_ie.getStyle(a,c);return tyz.PX(b)},getAttr:function(b,a){if(a=="class"){return b.className||""}return b.getAttribute(a)||""},setStyles:function(c,b){for(var a in b){if(a=="cssFloat"){c.style.styleFloat=b[a];continue}c.style[a]=b[a]}return c},checkVal_w:function(a){switch(a){case"width":case"marginLeft":case"marginRight":case"paddingLeft":case"paddingRight":case"borderLeftWidth":case"borderRightWidth":return true;default:return false}},checkVal_h:function(a){switch(a){case"height":case"marginTop":case"marginBottom":case"paddingTop":case"paddingBottom":case"borderTopWidth":case"borderBottomWidth":return true;default:return false}},getFontSize:function(d){var b=tyz.newEle("DIV",{},{width:"10em",letterSpacing:"normal"}),a;try{d.appendChild(b);a=Math.ceil(b.offsetWidth/10);d.removeChild(b)}catch(c){if(d.parentNode&&d.parentNode.nodeName!="HTML"){a=h2v_ie.getFontSize(d.parentNode)}else{a=14}}return a},getSize:function(f,h,b){var e=f.currentStyle[h];if(e.match("px")){return e.replace("px","")*1}if(e.match("%")){var d=e.replace("%","")/100,a=h2v_ie.checkVal_w(h)?"width":"height",g=h2v_ie.getSize(f.parentNode,a,true);return d*g}if(e.match("pt")){return tyz.round(e.replace("pt","")*3/4+0.01,0)}if(e.match("em")){return tyz.round(e.replace("em","")*tyz.PX(h2v_ie.getFontSize(f))+0.01,0)}if(e.match("auto")){if(h=="width"){return(f.offsetWidth-h2v_ie.getPxStyle(f,"paddingLeft")-h2v_ie.getPxStyle(f,"paddingRight")-h2v_ie.getPxStyle(f,"borderLeftWidth")-h2v_ie.getPxStyle(f,"borderRightWidth"))}if(h=="height"&&b){return(f.offsetHeight-h2v_ie.getPxStyle(f,"paddingTop")-h2v_ie.getPxStyle(f,"paddingBottom")-h2v_ie.getPxStyle(f,"borderTopWidth")-h2v_ie.getPxStyle(f,"borderBottomWidth"))}return 0}if(h.match(/border/)){var c=h2v_ie.getStyle(f,h.replace("Width","Style"));if(c!="none"&&c!="hidden"){if(e=="thin"){return 2}if(e=="medium"){return 4}if(e=="thick"){return 6}}return 0}return 0},extractRange:function(c,f){var e=document.createDocumentFragment();var h=c.childNodes.length;while(1){var b=c.firstChild;if(!b){break}if(b===f){e.appendChild(c.removeChild(b));break}var d=false;if(b.nodeName!="#text"){var g=f;if(g.nodeName=="#text"){g=g.parentNode;if(g.nodeName=="#document-fragment"){d=false}else{d=b.contains(g)}}else{d=b.contains(g)}}if(d){e.appendChild(b.cloneNode(false));var a=h2vconvert.extractRange(b,f);e.lastChild.appendChild(a);if(!b.hasChildNodes()){c.removeChild(b)}break}else{e.appendChild(c.removeChild(b))}}return e},extractNodeContents:function(c){var b=document.createDocumentFragment(),a=c.firstChild;while(a){b.appendChild(c.removeChild(a));a=c.firstChild}return b},getOH:function(a){var c=h2vconvert,d=a.cloneNode(true);c.tmpdiv.appendChild(d);var b=d.offsetHeight+1+"px";c.tmpdiv.removeChild(d);return b},setStyleSheet:function(){var a=document.styleSheets[document.styleSheets.length-1];a.addRule(".h2v_e span.h2v_sp","height:1em;");if(h2vconvert.envs.isIE8){var a=document.styleSheets[document.styleSheets.length-1];a.addRule(".h2v_e span.h2v_cho","filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1, mirror=1);");a.addRule(".h2v_e span.h2v_alpha,.h2v_e span.h2v_sp,.h2v_e span.h2v_rotate","filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);");a.addRule(".h2v_e .h2v_kakko_t,.h2v_e .h2v_kakko_b","filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);font-family:'ＭＳ ゴシック','MS Gochic' !important;")}}};(function(){var d=h2vconvert,e=d.envs;e.ua=navigator.userAgent.toLowerCase();var a=e.ua,f=window.opera?(opera.version().replace(/\d$/,"")-0):parseFloat((/(?:ie |fox\/|ome\/|ion\/|rv:)(\d+\.\d)/.exec(a)||[,0])[1]);if(/msie/.test(a)){if(document.documentMode!==undefined){f=document.documentMode}}if((/opera/.test(a)&&f<10.5)||(/firefox/.test(a)&&f<3.5)||((!/chrome/.test(a)&&!/opera/.test(a)&&/safari/.test(a)&&!/mobile/.test(a))&&f<3)||(/msie/.test(a)&&f<8)){e.isOld=true}if(/trident/.test(a)){e.isIE=true}if(/msie/.test(a)&&f<9){e.isIE8=true}if(e.isIE8){tyz.getStyle=h2v_ie.getStyle;tyz.getStyles=h2v_ie.getStyles;tyz.getPxStyle=h2v_ie.getPxStyle;tyz.setStyles=h2v_ie.setStyles;d.extractRange=h2v_ie.extractRange;d.extractNodeContents=h2v_ie.extractNodeContents;tyz.newEle("RB")}if(/webkit|opera/.test(a)){d.getExtraHeight=d.getExtraHeight_webkit}if(/firefox/.test(a)&&f>=38){e.isFF38=true;d.ruby_to_html4_style=d.ruby_to_html4_style_ff38}if(document.addEventListener){window.addEventListener("resize",h2vconvert.doresize,false)}else{window.attachEvent("onresize",h2vconvert.doresize)}var h,b,c;var j,g;if(/windows nt 5/.test(a)){h=d.kakko_t_a.concat(d.kakko_b_a,d.dash_a);b=d.kakko_t_r_a.concat(d.kakko_b_r_a,d.dash_r_a);d.orig_ex=RegExp("("+h.join("|")+")","g");for(c=0;c<h.length;c++){d.repl_a[h[c]]=b[c]}d.kakkos_tr+=d.kakko_t_kagi_a.join("");d.kakkos_br+=d.kakko_b_kagi_a.join("");j=d.kakko_t_r_a.join("");g=d.kakko_b_r_a.join("")}else{h=d.kakko_t_a.concat(d.kakko_b_a,d.kakko_t_kagi_a,d.kakko_b_kagi_a,d.dash_a);b=d.kakko_t_r_a.concat(d.kakko_b_r_a,d.kakko_t_kagi_r_a,d.kakko_b_kagi_r_a,d.dash_r_a);d.orig_ex=RegExp("("+h.join("|")+")","g");for(c=0;c<h.length;c++){d.repl_a[h[c]]=b[c]}j=d.kakko_t_r_a.join("")+d.kakko_t_kagi_r_a.join("");g=d.kakko_b_r_a.join("")+d.kakko_b_kagi_r_a.join("")}h2vconvert.ptn=RegExp("(["+d.komojis+"])|(["+d.rotate_mirrors+"])|(["+d.kutos+"])|( |\\u00A0)|([!-~‘”“’]+\\s?)|(["+j+"])|(["+g+"])|(["+d.kakkos_tr+"])|(["+d.kakkos_br+"])|(["+d.rotates+"])|([！？])","g")})();